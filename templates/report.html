{% extends 'layout.html' %}

{% block body %}

<h2 class="mt-5 mb-5 text-center">{{pred}}</h2>

<div class="mb-5">
  {{exp|safe}}
</div>


<h3 class="text-center mt-5">Patient vs Healthy vs Cardio</h3>
<canvas id="rbs_chol_max"></canvas>

<div class="mt-3" id="accordion">
  <div class="card">
    <div class="card-header" id="headingOne">
      <h5 class="mb-0">
        <button class="btn btn-exp" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
         <i class="fas fa-question-circle"></i> Explanation of values for each parameter in the graph
        </button>
      </h5>
    </div>

    <div id="collapseOne" class="collapse hide" aria-labelledby="headingOne" data-parent="#accordion">
      <div class="card-body">
       <h5>Chest pain type</h5> <p>typical - 1, typical angina - 2, non- anginal pain - 3, asymptomatic - 4</p>
       <h5>Fasting blood sugar</h5> <p>more than 120 mg/dl - 1, less or equal than 120 mg/dl - 0</p>
       <h5>Resting ECG</h5> <p>Normal - 0, Abnormality in ST-T wave - 1, Left ventricular hypertrophy - 2</p>
       <h5>Exercise Angina</h5> <p>No - 0, Yes - 1</p>
       <h5>Oldpeak</h5> <p>Exercise induced ST-depression in comparison with the state of rest (Numerical)</p>
       <h5>St Slope</h5> <p>Normal - 0, Upsloping - 1, Flat - 2, Downsloping - 3</p>
      </div>
    </div>
  </div>
</div>

<h3 class="text-center mt-5">Patient vs Healthy vs Cardio</h3>
<canvas id="second_graph"></canvas>

<h3 class="text-center mt-5">Age of Patient vs Cholestrol</h3>
<canvas id="scatterChart" width="400" height="200"></canvas>


<script>

  var dataX = {{ graphOne| tojson }};
  var healthyAvg = {{ healthyAvg| tojson }};
  var cardioAvg = {{ cardioAvg| tojson }};

  var ctx = document.getElementById("rbs_chol_max").getContext("2d");
  var chart = new Chart(ctx, {
    // The type of chart we want to create
    type: "radar",

    // The data for our dataset
    data: {
      labels: [
        "Chest pain type",
        "Fasting blood sugar",
        "Resting ecg",
        "Exercise angina",
        "Oldpeak",
        "ST slope"
      ],
      datasets: [
        {
          label: "Patient Values",
          pointBackgroundColor: "rgb(0, 0, 0,0.2)",
          borderColor: "rgb(0, 0, 0)",
          data: dataX,
        },
        {
          label: "Average Healthy Values",
          pointBackgroundColor: "rgb(0, 255, 0,0.3)",
          borderColor: "rgb(0, 255, 0)",
          data: healthyAvg,
        }, {
          label: "Average Cardio Values",
          pointBackgroundColor: "rgb(255, 0, 0,0.3)",
          borderColor: "rgb(255, 0, 0)",
          data: cardioAvg,
        },
      ],
    },

    // Configuration options go here
    options: {
    },
  });

  var dataTwo = {{ graphTwo| tojson }};
  var healthySecAvg = {{ healthySecAvg| tojson }};
  var cardioSecAvg = {{ cardioSecAvg| tojson }};

  var ctx = document.getElementById("second_graph").getContext("2d");
  var chart = new Chart(ctx, {
    // The type of chart we want to create
    type: "radar",

    // The data for our dataset
    data: {
      labels: [
        "Resting BP S",
        "Cholestrol",
        "Max heart"
      ],
      datasets: [
        {
          label: "Patient Values",
          pointBackgroundColor: "rgb(0, 0, 0,0.2)",
          borderColor: "rgb(0, 0, 0)",
          data: dataTwo,
        },
        {
          label: "Average Healthy Values",
          pointBackgroundColor: "rgb(0, 255, 0,0.3)",
          borderColor: "rgb(0, 255, 0)",
          data: healthySecAvg,
        }, {
          label: "Average Cardio Values",
          pointBackgroundColor: "rgb(255, 0, 0,0.3)",
          borderColor: "rgb(255, 0, 0)",
          data: cardioSecAvg,
        },
      ],
    },

    // Configuration options go here
    options: {
    },
  });


  var healChol = {{ healthyChol }}
  var healRBP = {{ healthyRBP }}

  var cardioChol = {{ cardioChol }}
  var cardioRBP = {{ cardioRBP }}

  let healthy = healRBP.map((v, i) => ({ x: v, y: healChol[i] }))
  let cardio = cardioRBP.map((v, i) => ({ x: v, y: cardioChol[i] }))

  let patientX = [{{ rbp }}]
  let patientY = [{{ chol }}]

  let patient = patientX.map((v, i) => ({ x: v, y: patientY[i] }))
  var ctx2 = document.getElementById("scatterChart").getContext("2d");
  var scatterChart = new Chart(ctx2, {
    type: 'scatter',
    data: {
      datasets: [{
        label: 'Healthy',
        pointBackgroundColor: "rgb(0, 255, 0, 0.3)",
        borderColor: "rgb(0, 255, 0)",
        data: healthy,
      }, {
        label: 'Cardio',
        pointBackgroundColor: "rgb(255, 0, 0, 0.3)",
        borderColor: "rgb(255, 0, 0)",
        data: cardio,
      }, {
        label: 'Patient',
        pointBackgroundColor: "rgb(0, 0, 255)",
        borderColor: "rgb(0, 0, 255)",
        data: patient,
        pointRadius: 10,
        pointHoverRadius: 12
      }],
      options: {
        title: {
          display: true,
          text: "Test"
        },
      },
    }
  });


</script>


{% endblock %}